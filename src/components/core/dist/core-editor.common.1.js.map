{"version":3,"sources":["webpack://core-editor/./node_modules/core-js/modules/es6.regexp.search.js","webpack://core-editor/./src/components/core/plugins/lbp-qq-map__editor.js","webpack://core-editor/./node_modules/core-js/modules/_same-value.js"],"names":["name","mixins","MapMixin","props","elementProps","type","Object","default","_default","labelContent","zoomLevel","methods","setPoi","poi","initSearch","self","keyword","searchService","window","qq","maps","SearchService","complete","results","setLocation","detail","cities","cityName","search","pois","setMarker","qqMapSearchElement","document","getElementById","ap","place","Autocomplete","event","addListener","res","value","listenZoom","_this","map","getZoom","initMap","center","Map","getPosition","latLng","el","zoom","disableDefaultUI","init","_this2","_this$elementProps","qqMapKey","loadMap","then","mounted","render","h","arguments"],"mappings":";;;;;;AAAa;;AAEb,eAAe,mBAAO,CAAC,MAAc;AACrC,gBAAgB,mBAAO,CAAC,MAAe;AACvC,iBAAiB,mBAAO,CAAC,MAAyB;;AAElD;AACA,mBAAO,CAAC,MAAe;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;;;;;;;;;;;;;;AC9BS;AACK;AAEA;EACbA,IAAI,EAAE,oBAAoB;EAC1BC,MAAM,EAAE,CAACC,qEAAQ,CAAC;EAAE;EACpBC,KAAK,EAAE;IACL;IACAC,YAAY,EAAE;MACZC,IAAI,EAAEC,MAAM;MACZC,OAAO,EAAE,SAAAC,SAAA;QAAA,OAAO;UACdC,YAAY,EAAE,EAAE;UAChBC,SAAS,EAAE;QACb,CAAC;MAAA;IACH;EACF,CAAC;EACDC,OAAO,EAAE;IACP;AACJ;AACA;AACA;IACIC,MAAM,WAAAA,OAAEC,GAAG,EAAE;MACX,IAAI,CAACT,YAAY,CAACS,GAAG,GAAGA,GAAG;IAC7B,CAAC;IACD;IACAC,UAAU,WAAAA,WAAA,EAAI;MACZ,IAAMC,IAAI,GAAG,IAAI;MACjB,IAAIC,OAAO,GAAG,EAAE;;MAEhB;MACA,IAAMC,aAAa,GAAG,IAAIC,MAAM,CAACC,EAAE,CAACC,IAAI,CAACC,aAAa,CAAC;QACrDC,QAAQ,EAAE,SAAAA,SAAAC,OAAO,EAAI;UACnB,IAAIA,OAAO,CAAClB,IAAI,KAAK,WAAW,EAAE;YAChCY,aAAa,CAACO,WAAW,CAACD,OAAO,CAACE,MAAM,CAACC,MAAM,CAAC,CAAC,CAAC,CAACC,QAAQ,CAAC;YAC5DV,aAAa,CAACW,MAAM,CAACZ,OAAO,CAAC;YAC7B;UACF;UACA,IAAMH,GAAG,GAAGU,OAAO,CAACE,MAAM,CAACI,IAAI,CAAC,CAAC,CAAC;UAClCd,IAAI,CAACe,SAAS,CAACjB,GAAG,CAAC;UACnBE,IAAI,CAACH,MAAM,CAACC,GAAG,CAAC;QAClB;MACF,CAAC,CAAC;MACF;MACA,IAAMkB,kBAAkB,GAAGC,QAAQ,CAACC,cAAc,CAAC,uBAAuB,CAAC;MAC3E,IAAMC,EAAE,GAAG,IAAIhB,MAAM,CAACC,EAAE,CAACC,IAAI,CAACe,KAAK,CAACC,YAAY,CAACL,kBAAkB,CAAC;MAEpEb,MAAM,CAACC,EAAE,CAACC,IAAI,CAACiB,KAAK,CAACC,WAAW,CAACJ,EAAE,EAAE,SAAS,EAAE,UAAUK,GAAG,EAAE;QAC7DvB,OAAO,GAAGuB,GAAG,CAACC,KAAK;QACnBvB,aAAa,CAACW,MAAM,CAACZ,OAAO,CAAC;MAC/B,CAAC,CAAC;IACJ,CAAC;IACD;AACJ;AACA;IACIyB,UAAU,WAAAA,WAAA,EAAI;MAAA,IAAAC,KAAA;MACZxB,MAAM,CAACC,EAAE,CAACC,IAAI,CAACiB,KAAK,CAACC,WAAW,CAAC,IAAI,CAACK,GAAG,EAAE,cAAc,EAAE,YAAM;QAC/DD,KAAI,CAACtC,YAAY,CAACM,SAAS,GAAGgC,KAAI,CAACC,GAAG,CAACC,OAAO,CAAC,CAAC;MAClD,CAAC,CAAC;IACJ,CAAC;IACDC,OAAO,WAAAA,QAAEhC,GAAG,EAAE;MACZ,IAAMiC,MAAM,GAAGC,mEAAG,CAACC,WAAW,CAACnC,GAAG,CAACoC,MAAM,CAAC,EAAC;MAC3C,IAAMC,EAAE,GAAGlB,QAAQ,CAACC,cAAc,CAAC,0BAA0B,CAAC;MAC9D,IAAI,CAACU,GAAG,GAAG,IAAIzB,MAAM,CAACC,EAAE,CAACC,IAAI,CAAC2B,GAAG,CAACG,EAAE,EAAE;QACpCJ,MAAM,EAANA,MAAM;QACNK,IAAI,EAAE,CAAC;QAAE;QACTC,gBAAgB,EAAE,IAAI,CAAC;QACvB;MACF,CAAC,CAAC;IACJ,CAAC;IACDC,IAAI,WAAAA,KAAA,EAAI;MAAA,IAAAC,MAAA;MACN,IAAAC,kBAAA,GAA0B,IAAI,CAACnD,YAAY;QAAnCS,GAAG,GAAA0C,kBAAA,CAAH1C,GAAG;QAAE2C,QAAQ,GAAAD,kBAAA,CAARC,QAAQ;MACrB,IAAI,CAACC,OAAO,CAACD,QAAQ,CAAC,CAACE,IAAI,CAAC,UAAAvC,EAAE,EAAI;QAChCmC,MAAI,CAACT,OAAO,CAAChC,GAAG,CAAC;QACjByC,MAAI,CAACxB,SAAS,CAACjB,GAAG,CAAC;QACnByC,MAAI,CAACxC,UAAU,CAAC,CAAC;QACjBwC,MAAI,CAACb,UAAU,CAAC,CAAC;MACnB,CAAC,CAAC;IACJ;EACF,CAAC;EACDkB,OAAO,WAAAA,QAAA,EAAI;IACT,IAAI,CAACN,IAAI,CAAC,CAAC;EACb,CAAC;EACDO,MAAM,WAAAA,OAAA,EAAI;IAAA,IAAAC,CAAA,GAAAC,SAAA;IACR,OAAAD,CAAA;MAAA,SACa;IAAe,IAAAA,CAAA;MAAA,OACb,QAAQ;MAAA;QAAA,MAAI,uBAAuB;QAAA,eAAa;MAAO;MAAA,SAAO;IAAkC,IAAAA,CAAA;MAAA;QAAA,MACnG;MAA0B;MAAA,SAAO;IAAiC;EAGhF;AACF,CAAC,E;;;;;;;AC1FD;AACA;AACA;AACA;AACA","file":"core-editor.common.1.js","sourcesContent":["'use strict';\n\nvar anObject = require('./_an-object');\nvar sameValue = require('./_same-value');\nvar regExpExec = require('./_regexp-exec-abstract');\n\n// @@search logic\nrequire('./_fix-re-wks')('search', 1, function (defined, SEARCH, $search, maybeCallNative) {\n  return [\n    // `String.prototype.search` method\n    // https://tc39.github.io/ecma262/#sec-string.prototype.search\n    function search(regexp) {\n      var O = defined(this);\n      var fn = regexp == undefined ? undefined : regexp[SEARCH];\n      return fn !== undefined ? fn.call(regexp, O) : new RegExp(regexp)[SEARCH](String(O));\n    },\n    // `RegExp.prototype[@@search]` method\n    // https://tc39.github.io/ecma262/#sec-regexp.prototype-@@search\n    function (regexp) {\n      var res = maybeCallNative($search, regexp, this);\n      if (res.done) return res.value;\n      var rx = anObject(regexp);\n      var S = String(this);\n      var previousLastIndex = rx.lastIndex;\n      if (!sameValue(previousLastIndex, 0)) rx.lastIndex = 0;\n      var result = regExpExec(rx, S);\n      if (!sameValue(rx.lastIndex, previousLastIndex)) rx.lastIndex = previousLastIndex;\n      return result === null ? -1 : result.index;\n    }\n  ];\n});\n","import Map from './lbp-qq-map/src/Map'\nimport MapMixin from './lbp-qq-map/src/mixin'\n\nexport default {\n  name: 'lbp-qq-map__editor',\n  mixins: [MapMixin], // loadMap、setMarker\n  props: {\n    // 地图的props 集合\n    elementProps: {\n      type: Object,\n      default: () => ({\n        labelContent: '',\n        zoomLevel: 12\n      })\n    }\n  },\n  methods: {\n    /**\n     * 更新组件的 poi prop\n     * @param {Object} poi 参考 lbp-qq-map 的 poi prop，用来表示坐标点信息\n     */\n    setPoi (poi) {\n      this.elementProps.poi = poi\n    },\n    // https://lbs.qq.com/webDemoCenter/javascriptV2/libraries/placeLibrary\n    initSearch () {\n      const self = this\n      let keyword = ''\n\n      // 调用Poi检索类。用于进行本地检索、周边检索等服务。\n      const searchService = new window.qq.maps.SearchService({\n        complete: results => {\n          if (results.type === 'CITY_LIST') {\n            searchService.setLocation(results.detail.cities[0].cityName)\n            searchService.search(keyword)\n            return\n          }\n          const poi = results.detail.pois[0]\n          self.setMarker(poi)\n          self.setPoi(poi)\n        }\n      })\n      // 添加监听事件\n      const qqMapSearchElement = document.getElementById('editor__qq-map-search')\n      const ap = new window.qq.maps.place.Autocomplete(qqMapSearchElement)\n\n      window.qq.maps.event.addListener(ap, 'confirm', function (res) {\n        keyword = res.value\n        searchService.search(keyword)\n      })\n    },\n    /**\n     * 监听地图 缩小/放大\n     */\n    listenZoom () {\n      window.qq.maps.event.addListener(this.map, 'zoom_changed', () => {\n        this.elementProps.zoomLevel = this.map.getZoom()\n      })\n    },\n    initMap (poi) {\n      const center = Map.getPosition(poi.latLng) // 地图的中心地理坐标\n      const el = document.getElementById('editor__qq-map-container')\n      this.map = new window.qq.maps.Map(el, {\n        center,\n        zoom: 8, // 设置地图的缩放级别\n        disableDefaultUI: true // 禁止所有控件\n        // 设置地图样式详情参见MapType\n      })\n    },\n    init () {\n      const { poi, qqMapKey } = this.elementProps\n      this.loadMap(qqMapKey).then(qq => {\n        this.initMap(poi)\n        this.setMarker(poi)\n        this.initSearch()\n        this.listenZoom()\n      })\n    }\n  },\n  mounted () {\n    this.init()\n  },\n  render () {\n    return (\n      <div style=\"margin: 12px;\">\n        <input ref=\"search\" id=\"editor__qq-map-search\" placeholder=\"请输入地名\" style=\"width: 100%;margin-bottom: 20px;\" />\n        <div id=\"editor__qq-map-container\" style=\"padding-bottom: 60%;width: 100%\"></div>\n      </div>\n    )\n  }\n}\n","// 7.2.9 SameValue(x, y)\nmodule.exports = Object.is || function is(x, y) {\n  // eslint-disable-next-line no-self-compare\n  return x === y ? x !== 0 || 1 / x === 1 / y : x != x && y != y;\n};\n"],"sourceRoot":""}